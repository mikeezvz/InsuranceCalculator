{"ast":null,"code":"/**\n * @class JSONSerialiser\n *\n * @param {Namespace} namespace\n *\n * @property {Namespace} namespace\n */\nclass JSONSerialiser {\n  constructor(namespace) {\n    this.namespace = namespace || new this.Namespace();\n  }\n\n  /**\n   * @param {Element} element\n   * @returns {object}\n   */\n  serialise(element) {\n    if (!(element instanceof this.namespace.elements.Element)) {\n      throw new TypeError(`Given element \\`${element}\\` is not an Element instance`);\n    }\n    const payload = {\n      element: element.element\n    };\n    if (element._meta && element._meta.length > 0) {\n      payload.meta = this.serialiseObject(element.meta);\n    }\n    if (element._attributes && element._attributes.length > 0) {\n      payload.attributes = this.serialiseObject(element.attributes);\n    }\n    const content = this.serialiseContent(element.content);\n    if (content !== undefined) {\n      payload.content = content;\n    }\n    return payload;\n  }\n\n  /**\n   * @param {object} value\n   * @returns {Element}\n   */\n  deserialise(value) {\n    if (!value.element) {\n      throw new Error('Given value is not an object containing an element name');\n    }\n    const ElementClass = this.namespace.getElementClass(value.element);\n    const element = new ElementClass();\n    if (element.element !== value.element) {\n      element.element = value.element;\n    }\n    if (value.meta) {\n      this.deserialiseObject(value.meta, element.meta);\n    }\n    if (value.attributes) {\n      this.deserialiseObject(value.attributes, element.attributes);\n    }\n    const content = this.deserialiseContent(value.content);\n    if (content !== undefined || element.content === null) {\n      element.content = content;\n    }\n    return element;\n  }\n\n  // Private API\n\n  serialiseContent(content) {\n    if (content instanceof this.namespace.elements.Element) {\n      return this.serialise(content);\n    }\n    if (content instanceof this.namespace.KeyValuePair) {\n      const pair = {\n        key: this.serialise(content.key)\n      };\n      if (content.value) {\n        pair.value = this.serialise(content.value);\n      }\n      return pair;\n    }\n    if (content && content.map) {\n      if (content.length === 0) {\n        return undefined;\n      }\n      return content.map(this.serialise, this);\n    }\n    return content;\n  }\n  deserialiseContent(content) {\n    if (content) {\n      if (content.element) {\n        return this.deserialise(content);\n      }\n      if (content.key) {\n        const pair = new this.namespace.KeyValuePair(this.deserialise(content.key));\n        if (content.value) {\n          pair.value = this.deserialise(content.value);\n        }\n        return pair;\n      }\n      if (content.map) {\n        return content.map(this.deserialise, this);\n      }\n    }\n    return content;\n  }\n  serialiseObject(obj) {\n    const result = {};\n    obj.forEach((value, key) => {\n      if (value) {\n        result[key.toValue()] = this.serialise(value);\n      }\n    });\n    if (Object.keys(result).length === 0) {\n      return undefined;\n    }\n    return result;\n  }\n  deserialiseObject(from, to) {\n    Object.keys(from).forEach(key => {\n      to.set(key, this.deserialise(from[key]));\n    });\n  }\n}\nmodule.exports = JSONSerialiser;","map":{"version":3,"names":["JSONSerialiser","constructor","namespace","Namespace","serialise","element","elements","Element","TypeError","payload","_meta","length","meta","serialiseObject","_attributes","attributes","content","serialiseContent","undefined","deserialise","value","Error","ElementClass","getElementClass","deserialiseObject","deserialiseContent","KeyValuePair","pair","key","map","obj","result","forEach","toValue","Object","keys","from","to","set","module","exports"],"sources":["/home/mikezvz/Documents/GitHub/InsuranceCalculator/frontend/node_modules/minim/lib/serialisers/JSONSerialiser.js"],"sourcesContent":["/**\n * @class JSONSerialiser\n *\n * @param {Namespace} namespace\n *\n * @property {Namespace} namespace\n */\nclass JSONSerialiser {\n  constructor(namespace) {\n    this.namespace = namespace || new this.Namespace();\n  }\n\n  /**\n   * @param {Element} element\n   * @returns {object}\n   */\n  serialise(element) {\n    if (!(element instanceof this.namespace.elements.Element)) {\n      throw new TypeError(`Given element \\`${element}\\` is not an Element instance`);\n    }\n\n    const payload = {\n      element: element.element,\n    };\n\n    if (element._meta && element._meta.length > 0) {\n      payload.meta = this.serialiseObject(element.meta);\n    }\n\n    if (element._attributes && element._attributes.length > 0) {\n      payload.attributes = this.serialiseObject(element.attributes);\n    }\n\n    const content = this.serialiseContent(element.content);\n\n    if (content !== undefined) {\n      payload.content = content;\n    }\n\n    return payload;\n  }\n\n  /**\n   * @param {object} value\n   * @returns {Element}\n   */\n  deserialise(value) {\n    if (!value.element) {\n      throw new Error('Given value is not an object containing an element name');\n    }\n\n    const ElementClass = this.namespace.getElementClass(value.element);\n    const element = new ElementClass();\n\n    if (element.element !== value.element) {\n      element.element = value.element;\n    }\n\n    if (value.meta) {\n      this.deserialiseObject(value.meta, element.meta);\n    }\n\n    if (value.attributes) {\n      this.deserialiseObject(value.attributes, element.attributes);\n    }\n\n    const content = this.deserialiseContent(value.content);\n    if (content !== undefined || element.content === null) {\n      element.content = content;\n    }\n\n    return element;\n  }\n\n  // Private API\n\n  serialiseContent(content) {\n    if (content instanceof this.namespace.elements.Element) {\n      return this.serialise(content);\n    }\n\n    if (content instanceof this.namespace.KeyValuePair) {\n      const pair = {\n        key: this.serialise(content.key),\n      };\n\n      if (content.value) {\n        pair.value = this.serialise(content.value);\n      }\n\n      return pair;\n    }\n\n    if (content && content.map) {\n      if (content.length === 0) {\n        return undefined;\n      }\n\n      return content.map(this.serialise, this);\n    }\n\n    return content;\n  }\n\n  deserialiseContent(content) {\n    if (content) {\n      if (content.element) {\n        return this.deserialise(content);\n      }\n\n      if (content.key) {\n        const pair = new this.namespace.KeyValuePair(this.deserialise(content.key));\n\n        if (content.value) {\n          pair.value = this.deserialise(content.value);\n        }\n\n        return pair;\n      }\n\n      if (content.map) {\n        return content.map(this.deserialise, this);\n      }\n    }\n\n    return content;\n  }\n\n  serialiseObject(obj) {\n    const result = {};\n\n    obj.forEach((value, key) => {\n      if (value) {\n        result[key.toValue()] = this.serialise(value);\n      }\n    });\n\n    if (Object.keys(result).length === 0) {\n      return undefined;\n    }\n\n    return result;\n  }\n\n  deserialiseObject(from, to) {\n    Object.keys(from).forEach((key) => {\n      to.set(key, this.deserialise(from[key]));\n    });\n  }\n}\n\n\nmodule.exports = JSONSerialiser;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}