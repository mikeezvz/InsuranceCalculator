{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { Matcher } from './matcher';\nimport { alphaNumericAndMarksCharsStr } from '../regex-lib';\nimport { MentionMatch } from '../match/mention-match';\n// RegExp objects which are shared by all instances of MentionMatcher. These are\n// here to avoid re-instantiating the RegExp objects if `Autolinker.link()` is\n// called multiple times, thus instantiating MentionMatcher and its RegExp\n// objects each time (which is very expensive - see https://github.com/gregjacobs/Autolinker.js/issues/314).\n// See descriptions of the properties where they are used for details about them\nvar twitterRegex = new RegExp(\"@[_\".concat(alphaNumericAndMarksCharsStr, \"]{1,50}(?![_\").concat(alphaNumericAndMarksCharsStr, \"])\"), 'g'); // lookahead used to make sure we don't match something above 50 characters\nvar instagramRegex = new RegExp(\"@[_.\".concat(alphaNumericAndMarksCharsStr, \"]{1,30}(?![_\").concat(alphaNumericAndMarksCharsStr, \"])\"), 'g'); // lookahead used to make sure we don't match something above 30 characters\nvar soundcloudRegex = new RegExp(\"@[-_.\".concat(alphaNumericAndMarksCharsStr, \"]{1,50}(?![-_\").concat(alphaNumericAndMarksCharsStr, \"])\"), 'g'); // lookahead used to make sure we don't match something above 50 characters\n// TikTok usernames are 1-24 characters containing letters, numbers, underscores\n// and periods, but cannot end in a period: https://support.tiktok.com/en/getting-started/setting-up-your-profile/changing-your-username\nvar tiktokRegex = new RegExp(\"@[_.\".concat(alphaNumericAndMarksCharsStr, \"]{1,23}[_\").concat(alphaNumericAndMarksCharsStr, \"](?![_\").concat(alphaNumericAndMarksCharsStr, \"])\"), 'g'); // lookahead used to make sure we don't match something above 24 characters\nvar nonWordCharRegex = new RegExp('[^' + alphaNumericAndMarksCharsStr + ']');\n/**\n * @class Autolinker.matcher.Mention\n * @extends Autolinker.matcher.Matcher\n *\n * Matcher to find/replace username matches in an input string.\n */\nvar MentionMatcher = /** @class */function (_super) {\n  __extends(MentionMatcher, _super);\n  /**\n   * @method constructor\n   * @param {Object} cfg The configuration properties for the Match instance,\n   *   specified in an Object (map).\n   */\n  function MentionMatcher(cfg) {\n    var _this = _super.call(this, cfg) || this;\n    /**\n     * @cfg {'twitter'/'instagram'/'soundcloud'} protected\n     *\n     * The name of service to link @mentions to.\n     *\n     * Valid values are: 'twitter', 'instagram', 'soundcloud', or 'tiktok'\n     */\n    _this.serviceName = 'twitter'; // default value just to get the above doc comment in the ES5 output and documentation generator\n    /**\n     * Hash of regular expression to match username handles. Example match:\n     *\n     *     @asdf\n     *\n     * @private\n     * @property {Object} matcherRegexes\n     */\n    _this.matcherRegexes = {\n      twitter: twitterRegex,\n      instagram: instagramRegex,\n      soundcloud: soundcloudRegex,\n      tiktok: tiktokRegex\n    };\n    /**\n     * The regular expression to use to check the character before a username match to\n     * make sure we didn't accidentally match an email address.\n     *\n     * For example, the string \"asdf@asdf.com\" should not match \"@asdf\" as a username.\n     *\n     * @private\n     * @property {RegExp} nonWordCharRegex\n     */\n    _this.nonWordCharRegex = nonWordCharRegex;\n    _this.serviceName = cfg.serviceName;\n    return _this;\n  }\n  /**\n   * @inheritdoc\n   */\n  MentionMatcher.prototype.parseMatches = function (text) {\n    var serviceName = this.serviceName,\n      matcherRegex = this.matcherRegexes[this.serviceName],\n      nonWordCharRegex = this.nonWordCharRegex,\n      tagBuilder = this.tagBuilder,\n      matches = [],\n      match;\n    if (!matcherRegex) {\n      return matches;\n    }\n    while ((match = matcherRegex.exec(text)) !== null) {\n      var offset = match.index,\n        prevChar = text.charAt(offset - 1);\n      // If we found the match at the beginning of the string, or we found the match\n      // and there is a whitespace char in front of it (meaning it is not an email\n      // address), then it is a username match.\n      if (offset === 0 || nonWordCharRegex.test(prevChar)) {\n        var matchedText = match[0].replace(/\\.+$/g, ''),\n          // strip off trailing .\n          mention = matchedText.slice(1); // strip off the '@' character at the beginning\n        matches.push(new MentionMatch({\n          tagBuilder: tagBuilder,\n          matchedText: matchedText,\n          offset: offset,\n          serviceName: serviceName,\n          mention: mention\n        }));\n      }\n    }\n    return matches;\n  };\n  return MentionMatcher;\n}(Matcher);\nexport { MentionMatcher };","map":{"version":3,"names":["Matcher","alphaNumericAndMarksCharsStr","MentionMatch","twitterRegex","RegExp","concat","instagramRegex","soundcloudRegex","tiktokRegex","nonWordCharRegex","MentionMatcher","_super","__extends","cfg","_this","call","serviceName","matcherRegexes","twitter","instagram","soundcloud","tiktok","prototype","parseMatches","text","matcherRegex","tagBuilder","matches","match","exec","offset","index","prevChar","charAt","test","matchedText","replace","mention","slice","push"],"sources":["../../../src/matcher/mention-matcher.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}