{"ast":null,"code":"import { cloneDeep } from '@swagger-api/apidom-core';\nimport NormalizeStorage from \"./NormalizeStorage.mjs\";\n/**\n * Override of Schema.example and Schema.examples field inside the Header Objects.\n *\n * Header Object has two fixed fields:\n *  - `example` of type `Any`\n *  - `examples` of type `Map[string, Example Object | Reference Object]`\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * The example value SHALL override the example provided by the schema.\n * Furthermore, if referencing a schema that contains an example, the examples value SHALL override the example provided by the schema.\n *\n * NOTE: this plugin is idempotent\n */\nconst plugin = ({\n  storageField = 'x-normalized'\n} = {}) => toolbox => {\n  const {\n    predicates,\n    ancestorLineageToJSONPointer\n  } = toolbox;\n  let storage;\n  return {\n    visitor: {\n      OpenApi3_1Element: {\n        enter(element) {\n          storage = new NormalizeStorage(element, storageField, 'header-examples');\n        },\n        leave() {\n          storage = undefined;\n        }\n      },\n      HeaderElement: {\n        leave(headerElement, key, parent, path, ancestors) {\n          var _headerElement$schema, _headerElement$schema2;\n          // skip visiting this Header Object\n          if (ancestors.some(predicates.isComponentsElement)) {\n            return;\n          }\n\n          // no Header.schema field present\n          if (typeof headerElement.schema === 'undefined' || !predicates.isSchemaElement(headerElement.schema)) {\n            return;\n          }\n          // Schema contains no example\n          if (typeof ((_headerElement$schema = headerElement.schema) === null || _headerElement$schema === void 0 ? void 0 : _headerElement$schema.example) === 'undefined' && typeof ((_headerElement$schema2 = headerElement.schema) === null || _headerElement$schema2 === void 0 ? void 0 : _headerElement$schema2.examples) === 'undefined') {\n            return;\n          }\n          const headerJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, headerElement]);\n\n          // skip visiting this Header Object if it's already normalized\n          if (storage.includes(headerJSONPointer)) {\n            return;\n          }\n\n          /**\n           * Header.examples and Schema.examples have preferences over the older\n           * and deprected `example` field.\n           */\n          if (typeof headerElement.examples !== 'undefined' && predicates.isObjectElement(headerElement.examples)) {\n            // @ts-ignore\n            const examples = headerElement.examples.map(example => {\n              return cloneDeep.safe(example.value);\n            });\n            if (typeof headerElement.schema.examples !== 'undefined') {\n              headerElement.schema.set('examples', examples);\n              storage.append(headerJSONPointer);\n            }\n            if (typeof headerElement.schema.example !== 'undefined') {\n              headerElement.schema.set('example', examples[0]);\n              storage.append(headerJSONPointer);\n            }\n            return;\n          }\n\n          /**\n           * Handle deprecated `example` field.\n           */\n          if (typeof headerElement.example !== 'undefined') {\n            if (typeof headerElement.schema.examples !== 'undefined') {\n              headerElement.schema.set('examples', [cloneDeep(headerElement.example)]);\n              storage.append(headerJSONPointer);\n            }\n            if (typeof headerElement.schema.example !== 'undefined') {\n              headerElement.schema.set('example', cloneDeep(headerElement.example));\n              storage.append(headerJSONPointer);\n            }\n          }\n        }\n      }\n    }\n  };\n};\nexport default plugin;","map":{"version":3,"names":["cloneDeep","NormalizeStorage","plugin","storageField","toolbox","predicates","ancestorLineageToJSONPointer","storage","visitor","OpenApi3_1Element","enter","element","leave","undefined","HeaderElement","headerElement","key","parent","path","ancestors","_headerElement$schema","_headerElement$schema2","some","isComponentsElement","schema","isSchemaElement","example","examples","headerJSONPointer","includes","isObjectElement","map","safe","value","set","append"],"sources":["/home/mikezvz/Documents/GitHub/InsuranceCalculator/frontend/node_modules/@swagger-api/apidom-ns-openapi-3-1/es/refractor/plugins/normalize-header-examples/index.mjs"],"sourcesContent":["import { cloneDeep } from '@swagger-api/apidom-core';\nimport NormalizeStorage from \"./NormalizeStorage.mjs\";\n/**\n * Override of Schema.example and Schema.examples field inside the Header Objects.\n *\n * Header Object has two fixed fields:\n *  - `example` of type `Any`\n *  - `examples` of type `Map[string, Example Object | Reference Object]`\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * The example value SHALL override the example provided by the schema.\n * Furthermore, if referencing a schema that contains an example, the examples value SHALL override the example provided by the schema.\n *\n * NOTE: this plugin is idempotent\n */\nconst plugin = ({\n  storageField = 'x-normalized'\n} = {}) => toolbox => {\n  const {\n    predicates,\n    ancestorLineageToJSONPointer\n  } = toolbox;\n  let storage;\n  return {\n    visitor: {\n      OpenApi3_1Element: {\n        enter(element) {\n          storage = new NormalizeStorage(element, storageField, 'header-examples');\n        },\n        leave() {\n          storage = undefined;\n        }\n      },\n      HeaderElement: {\n        leave(headerElement, key, parent, path, ancestors) {\n          var _headerElement$schema, _headerElement$schema2;\n          // skip visiting this Header Object\n          if (ancestors.some(predicates.isComponentsElement)) {\n            return;\n          }\n\n          // no Header.schema field present\n          if (typeof headerElement.schema === 'undefined' || !predicates.isSchemaElement(headerElement.schema)) {\n            return;\n          }\n          // Schema contains no example\n          if (typeof ((_headerElement$schema = headerElement.schema) === null || _headerElement$schema === void 0 ? void 0 : _headerElement$schema.example) === 'undefined' && typeof ((_headerElement$schema2 = headerElement.schema) === null || _headerElement$schema2 === void 0 ? void 0 : _headerElement$schema2.examples) === 'undefined') {\n            return;\n          }\n          const headerJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, headerElement]);\n\n          // skip visiting this Header Object if it's already normalized\n          if (storage.includes(headerJSONPointer)) {\n            return;\n          }\n\n          /**\n           * Header.examples and Schema.examples have preferences over the older\n           * and deprected `example` field.\n           */\n          if (typeof headerElement.examples !== 'undefined' && predicates.isObjectElement(headerElement.examples)) {\n            // @ts-ignore\n            const examples = headerElement.examples.map(example => {\n              return cloneDeep.safe(example.value);\n            });\n            if (typeof headerElement.schema.examples !== 'undefined') {\n              headerElement.schema.set('examples', examples);\n              storage.append(headerJSONPointer);\n            }\n            if (typeof headerElement.schema.example !== 'undefined') {\n              headerElement.schema.set('example', examples[0]);\n              storage.append(headerJSONPointer);\n            }\n            return;\n          }\n\n          /**\n           * Handle deprecated `example` field.\n           */\n          if (typeof headerElement.example !== 'undefined') {\n            if (typeof headerElement.schema.examples !== 'undefined') {\n              headerElement.schema.set('examples', [cloneDeep(headerElement.example)]);\n              storage.append(headerJSONPointer);\n            }\n            if (typeof headerElement.schema.example !== 'undefined') {\n              headerElement.schema.set('example', cloneDeep(headerElement.example));\n              storage.append(headerJSONPointer);\n            }\n          }\n        }\n      }\n    }\n  };\n};\nexport default plugin;"],"mappings":"AAAA,SAASA,SAAS,QAAQ,0BAA0B;AACpD,OAAOC,gBAAgB,MAAM,wBAAwB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,MAAM,GAAGA,CAAC;EACdC,YAAY,GAAG;AACjB,CAAC,GAAG,CAAC,CAAC,KAAKC,OAAO,IAAI;EACpB,MAAM;IACJC,UAAU;IACVC;EACF,CAAC,GAAGF,OAAO;EACX,IAAIG,OAAO;EACX,OAAO;IACLC,OAAO,EAAE;MACPC,iBAAiB,EAAE;QACjBC,KAAKA,CAACC,OAAO,EAAE;UACbJ,OAAO,GAAG,IAAIN,gBAAgB,CAACU,OAAO,EAAER,YAAY,EAAE,iBAAiB,CAAC;QAC1E,CAAC;QACDS,KAAKA,CAAA,EAAG;UACNL,OAAO,GAAGM,SAAS;QACrB;MACF,CAAC;MACDC,aAAa,EAAE;QACbF,KAAKA,CAACG,aAAa,EAAEC,GAAG,EAAEC,MAAM,EAAEC,IAAI,EAAEC,SAAS,EAAE;UACjD,IAAIC,qBAAqB,EAAEC,sBAAsB;UACjD;UACA,IAAIF,SAAS,CAACG,IAAI,CAACjB,UAAU,CAACkB,mBAAmB,CAAC,EAAE;YAClD;UACF;;UAEA;UACA,IAAI,OAAOR,aAAa,CAACS,MAAM,KAAK,WAAW,IAAI,CAACnB,UAAU,CAACoB,eAAe,CAACV,aAAa,CAACS,MAAM,CAAC,EAAE;YACpG;UACF;UACA;UACA,IAAI,QAAQ,CAACJ,qBAAqB,GAAGL,aAAa,CAACS,MAAM,MAAM,IAAI,IAAIJ,qBAAqB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,qBAAqB,CAACM,OAAO,CAAC,KAAK,WAAW,IAAI,QAAQ,CAACL,sBAAsB,GAAGN,aAAa,CAACS,MAAM,MAAM,IAAI,IAAIH,sBAAsB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,sBAAsB,CAACM,QAAQ,CAAC,KAAK,WAAW,EAAE;YACtU;UACF;UACA,MAAMC,iBAAiB,GAAGtB,4BAA4B,CAAC,CAAC,GAAGa,SAAS,EAAEF,MAAM,EAAEF,aAAa,CAAC,CAAC;;UAE7F;UACA,IAAIR,OAAO,CAACsB,QAAQ,CAACD,iBAAiB,CAAC,EAAE;YACvC;UACF;;UAEA;AACV;AACA;AACA;UACU,IAAI,OAAOb,aAAa,CAACY,QAAQ,KAAK,WAAW,IAAItB,UAAU,CAACyB,eAAe,CAACf,aAAa,CAACY,QAAQ,CAAC,EAAE;YACvG;YACA,MAAMA,QAAQ,GAAGZ,aAAa,CAACY,QAAQ,CAACI,GAAG,CAACL,OAAO,IAAI;cACrD,OAAO1B,SAAS,CAACgC,IAAI,CAACN,OAAO,CAACO,KAAK,CAAC;YACtC,CAAC,CAAC;YACF,IAAI,OAAOlB,aAAa,CAACS,MAAM,CAACG,QAAQ,KAAK,WAAW,EAAE;cACxDZ,aAAa,CAACS,MAAM,CAACU,GAAG,CAAC,UAAU,EAAEP,QAAQ,CAAC;cAC9CpB,OAAO,CAAC4B,MAAM,CAACP,iBAAiB,CAAC;YACnC;YACA,IAAI,OAAOb,aAAa,CAACS,MAAM,CAACE,OAAO,KAAK,WAAW,EAAE;cACvDX,aAAa,CAACS,MAAM,CAACU,GAAG,CAAC,SAAS,EAAEP,QAAQ,CAAC,CAAC,CAAC,CAAC;cAChDpB,OAAO,CAAC4B,MAAM,CAACP,iBAAiB,CAAC;YACnC;YACA;UACF;;UAEA;AACV;AACA;UACU,IAAI,OAAOb,aAAa,CAACW,OAAO,KAAK,WAAW,EAAE;YAChD,IAAI,OAAOX,aAAa,CAACS,MAAM,CAACG,QAAQ,KAAK,WAAW,EAAE;cACxDZ,aAAa,CAACS,MAAM,CAACU,GAAG,CAAC,UAAU,EAAE,CAAClC,SAAS,CAACe,aAAa,CAACW,OAAO,CAAC,CAAC,CAAC;cACxEnB,OAAO,CAAC4B,MAAM,CAACP,iBAAiB,CAAC;YACnC;YACA,IAAI,OAAOb,aAAa,CAACS,MAAM,CAACE,OAAO,KAAK,WAAW,EAAE;cACvDX,aAAa,CAACS,MAAM,CAACU,GAAG,CAAC,SAAS,EAAElC,SAAS,CAACe,aAAa,CAACW,OAAO,CAAC,CAAC;cACrEnB,OAAO,CAAC4B,MAAM,CAACP,iBAAiB,CAAC;YACnC;UACF;QACF;MACF;IACF;EACF,CAAC;AACH,CAAC;AACD,eAAe1B,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}