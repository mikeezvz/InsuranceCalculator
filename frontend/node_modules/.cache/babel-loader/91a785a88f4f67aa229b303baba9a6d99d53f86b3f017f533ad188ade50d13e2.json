{"ast":null,"code":"import { OperationSecurityElement } from '@swagger-api/apidom-ns-openapi-3-0';\nimport NormalizeStorage from \"./normalize-header-examples/NormalizeStorage.mjs\";\n/**\n * Override of Security Requirement Objects.\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * Operation.security definition overrides any declared top-level security.\n * To remove a top-level security declaration, an empty array can be used.\n * When a list of Security Requirement Objects is defined on the OpenAPI Object or Operation Object,\n * only one of the Security Requirement Objects in the list needs to be satisfied to authorize the request.\n *\n * NOTE: this plugin is idempotent\n */\n/* eslint-disable no-param-reassign */\nconst plugin = ({\n  storageField = 'x-normalized'\n} = {}) => toolbox => {\n  const {\n    predicates,\n    ancestorLineageToJSONPointer\n  } = toolbox;\n  let topLevelSecurity;\n  let storage;\n  return {\n    visitor: {\n      OpenApi3_1Element: {\n        enter(openapiElement) {\n          storage = new NormalizeStorage(openapiElement, storageField, 'security-requirements');\n          if (predicates.isArrayElement(openapiElement.security)) {\n            topLevelSecurity = openapiElement.security;\n          }\n        },\n        leave() {\n          storage = undefined;\n          topLevelSecurity = undefined;\n        }\n      },\n      OperationElement: {\n        leave(operationElement, key, parent, path, ancestors) {\n          // skip visiting this Operation\n          if (ancestors.some(predicates.isComponentsElement)) {\n            return;\n          }\n          const operationJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, operationElement]);\n\n          // skip visiting this Operation Object if it's already normalized\n          if (storage.includes(operationJSONPointer)) {\n            return;\n          }\n          const missingOperationLevelSecurity = typeof operationElement.security === 'undefined';\n          const hasTopLevelSecurity = typeof topLevelSecurity !== 'undefined';\n          if (missingOperationLevelSecurity && hasTopLevelSecurity) {\n            var _topLevelSecurity;\n            operationElement.security = new OperationSecurityElement((_topLevelSecurity = topLevelSecurity) === null || _topLevelSecurity === void 0 ? void 0 : _topLevelSecurity.content);\n            storage.append(operationJSONPointer);\n          }\n        }\n      }\n    }\n  };\n};\n/* eslint-enable */\n\nexport default plugin;","map":{"version":3,"names":["OperationSecurityElement","NormalizeStorage","plugin","storageField","toolbox","predicates","ancestorLineageToJSONPointer","topLevelSecurity","storage","visitor","OpenApi3_1Element","enter","openapiElement","isArrayElement","security","leave","undefined","OperationElement","operationElement","key","parent","path","ancestors","some","isComponentsElement","operationJSONPointer","includes","missingOperationLevelSecurity","hasTopLevelSecurity","_topLevelSecurity","content","append"],"sources":["/home/mikezvz/Documents/GitHub/InsuranceCalculator/frontend/node_modules/@swagger-api/apidom-ns-openapi-3-1/es/refractor/plugins/normalize-security-requirements.mjs"],"sourcesContent":["import { OperationSecurityElement } from '@swagger-api/apidom-ns-openapi-3-0';\nimport NormalizeStorage from \"./normalize-header-examples/NormalizeStorage.mjs\";\n/**\n * Override of Security Requirement Objects.\n *\n * OpenAPI 3.1 specification excerpt that defines the override behavior:\n *\n * Operation.security definition overrides any declared top-level security.\n * To remove a top-level security declaration, an empty array can be used.\n * When a list of Security Requirement Objects is defined on the OpenAPI Object or Operation Object,\n * only one of the Security Requirement Objects in the list needs to be satisfied to authorize the request.\n *\n * NOTE: this plugin is idempotent\n */\n/* eslint-disable no-param-reassign */\nconst plugin = ({\n  storageField = 'x-normalized'\n} = {}) => toolbox => {\n  const {\n    predicates,\n    ancestorLineageToJSONPointer\n  } = toolbox;\n  let topLevelSecurity;\n  let storage;\n  return {\n    visitor: {\n      OpenApi3_1Element: {\n        enter(openapiElement) {\n          storage = new NormalizeStorage(openapiElement, storageField, 'security-requirements');\n          if (predicates.isArrayElement(openapiElement.security)) {\n            topLevelSecurity = openapiElement.security;\n          }\n        },\n        leave() {\n          storage = undefined;\n          topLevelSecurity = undefined;\n        }\n      },\n      OperationElement: {\n        leave(operationElement, key, parent, path, ancestors) {\n          // skip visiting this Operation\n          if (ancestors.some(predicates.isComponentsElement)) {\n            return;\n          }\n          const operationJSONPointer = ancestorLineageToJSONPointer([...ancestors, parent, operationElement]);\n\n          // skip visiting this Operation Object if it's already normalized\n          if (storage.includes(operationJSONPointer)) {\n            return;\n          }\n          const missingOperationLevelSecurity = typeof operationElement.security === 'undefined';\n          const hasTopLevelSecurity = typeof topLevelSecurity !== 'undefined';\n          if (missingOperationLevelSecurity && hasTopLevelSecurity) {\n            var _topLevelSecurity;\n            operationElement.security = new OperationSecurityElement((_topLevelSecurity = topLevelSecurity) === null || _topLevelSecurity === void 0 ? void 0 : _topLevelSecurity.content);\n            storage.append(operationJSONPointer);\n          }\n        }\n      }\n    }\n  };\n};\n/* eslint-enable */\n\nexport default plugin;"],"mappings":"AAAA,SAASA,wBAAwB,QAAQ,oCAAoC;AAC7E,OAAOC,gBAAgB,MAAM,kDAAkD;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,MAAM,GAAGA,CAAC;EACdC,YAAY,GAAG;AACjB,CAAC,GAAG,CAAC,CAAC,KAAKC,OAAO,IAAI;EACpB,MAAM;IACJC,UAAU;IACVC;EACF,CAAC,GAAGF,OAAO;EACX,IAAIG,gBAAgB;EACpB,IAAIC,OAAO;EACX,OAAO;IACLC,OAAO,EAAE;MACPC,iBAAiB,EAAE;QACjBC,KAAKA,CAACC,cAAc,EAAE;UACpBJ,OAAO,GAAG,IAAIP,gBAAgB,CAACW,cAAc,EAAET,YAAY,EAAE,uBAAuB,CAAC;UACrF,IAAIE,UAAU,CAACQ,cAAc,CAACD,cAAc,CAACE,QAAQ,CAAC,EAAE;YACtDP,gBAAgB,GAAGK,cAAc,CAACE,QAAQ;UAC5C;QACF,CAAC;QACDC,KAAKA,CAAA,EAAG;UACNP,OAAO,GAAGQ,SAAS;UACnBT,gBAAgB,GAAGS,SAAS;QAC9B;MACF,CAAC;MACDC,gBAAgB,EAAE;QAChBF,KAAKA,CAACG,gBAAgB,EAAEC,GAAG,EAAEC,MAAM,EAAEC,IAAI,EAAEC,SAAS,EAAE;UACpD;UACA,IAAIA,SAAS,CAACC,IAAI,CAAClB,UAAU,CAACmB,mBAAmB,CAAC,EAAE;YAClD;UACF;UACA,MAAMC,oBAAoB,GAAGnB,4BAA4B,CAAC,CAAC,GAAGgB,SAAS,EAAEF,MAAM,EAAEF,gBAAgB,CAAC,CAAC;;UAEnG;UACA,IAAIV,OAAO,CAACkB,QAAQ,CAACD,oBAAoB,CAAC,EAAE;YAC1C;UACF;UACA,MAAME,6BAA6B,GAAG,OAAOT,gBAAgB,CAACJ,QAAQ,KAAK,WAAW;UACtF,MAAMc,mBAAmB,GAAG,OAAOrB,gBAAgB,KAAK,WAAW;UACnE,IAAIoB,6BAA6B,IAAIC,mBAAmB,EAAE;YACxD,IAAIC,iBAAiB;YACrBX,gBAAgB,CAACJ,QAAQ,GAAG,IAAId,wBAAwB,CAAC,CAAC6B,iBAAiB,GAAGtB,gBAAgB,MAAM,IAAI,IAAIsB,iBAAiB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,iBAAiB,CAACC,OAAO,CAAC;YAC9KtB,OAAO,CAACuB,MAAM,CAACN,oBAAoB,CAAC;UACtC;QACF;MACF;IACF;EACF,CAAC;AACH,CAAC;AACD;;AAEA,eAAevB,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}